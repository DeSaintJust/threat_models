# https://www.cyber.gov.au/about-us/view-all-content/alerts-and-advisories/russian-military-cyber-actors-target-us-and-global-critical-infrastructure
# === Propositions ===
p1 = "Initial access gained to enterprise network"
p2 = "Privilege escalation on targeted systems"
p3 = "WhisperGate loader deployed"
p4 = "Destructive payload executed (overwrites MBR or corrupts files)"
p5 = "Critical systems rendered inoperable"
p6 = "Persistence established to reinfect on reboot"
p7 = "Security telemetry/logs are wiped or corrupted"
p8 = "Data recovery is impossible or incomplete"

# === Mitigations ===
m1 = "Endpoint Detection & Response (EDR) blocks execution of suspicious loaders"
m2 = "Application control prevents unsigned binaries from running"
m3 = "Privileged access is locked down and monitored"
m4 = "MBR/boot sector protections are enforced (e.g., UEFI Secure Boot)"
m5 = "Immutable logging (e.g., write-once SIEM or remote syslog)"
m6 = "Frequent, offline, and integrity-checked backups"
m7 = "Segmentation prevents lateral movement to critical systems"
m8 = "Incident response playbooks are tested and ready"

# === Modal Logic Relations ===

# Possibility: If initial access is gained, malware deployment is possible
if p1 and p2:
    Diamond(p3)

# Possibility: If malware loader is deployed, destruction may follow
if p3:
    Diamond(p4)

# Consequence: Destruction implies system downtime and unrecoverable data
if p4:
    Diamond(p5)
    Diamond(p7)
    Diamond(p8)

# Persistence logic
if p3 and not m2:
    Diamond(p6)

# === Mitigation effects (necessity) ===

if m1 and m2:
    Box(not p3)

if m3 and m4:
    Box(not p2)

if m5:
    Box(not p7)

if m6:
    Box(not p8)

# === Kripke Model ===

model = {
    "W": {
        "w0": "Pre-attack (normal operation)",
        "w1": "Initial access",
        "w2": "Malware loader deployed",
        "w3": "Destructive payload executed"
    },
    "R": [
        ["w0", "w1"],
        ["w1", "w2"],
        ["w2", "w3"],
        ["w2", "w1"],  # possible rollback or loop due to persistence
    ],
    "v": {
        "w0": [],
        "w1": [p1, p2],
        "w2": [p3],
        "w3": [p4, p5, p7, p8]
    }
}
